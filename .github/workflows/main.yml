name : main
on :
  push :
    branches:
    - main
jobs:
  build-deploy:
    runs-on : Ubuntu-latest
 
    steps :
    - name : Checkout
      uses : actions/checkout@v4

    - name: Setup SSH Key
      uses: webfactory/ssh-agent@v0.9.0
      with:
        ssh-private-key: ${{ secrets.EC2_SSH_KEY }}
 
    - name : Copy project file on EC2
      run: |
           ssh -o StrictHostKeyChecking=no ubuntu@${{ secrets.EC2_HOST }} << 'EOF'
           cd ~/GitHub-Action_test/Shopify
           git pull origin main
           npm install
           npm run start
           EOF
           env:
           EC2_SSH_KEY: ${{ secrets.EC2_SSH_KEY }}
